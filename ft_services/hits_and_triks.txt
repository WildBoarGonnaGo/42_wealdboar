WildBoar, [10.12.20 02:41]
Всем ночи доброй! Я так понял для работы во всех контейнерах должен стоять супервайзер?

CDdoma, [10.12.20 02:56]
Можешь поставить в любой, можешь вообще его не использовать

WildBoar, [10.12.20 03:24]
спасиб)

CDdoma, [10.12.20 03:43]
супервизор нужен, чтобы запускать сервисы, поддерживать их в запущенном состоянии и закрывать, если понадобиться (в случае, когда один из сервисом умер или мы его убили, супервизор может убить все остальные, чтобы Под закрылся, чтобы в свою очередь Деплоймент этот Под перезапустил)

CDdoma, [10.12.20 03:46]
Сервисы можно запускать в демон режиме, тогда супервизор не нужен. Проверять, не умер ли какой-нибудь из сервисов тоже можно делать без супервизора, например циклом постоянно проверять, но супервизором это делать лучше

WildBoar, [10.12.20 03:56]
@cddoma Скопипастил твой ответ)) Спасибо) А mysql по дефолту запускается в режиме демона?

CDdoma, [10.12.20 03:58]
в демоне mysqld

WildBoar, [10.12.20 04:27]
Спасибо)

КАК СМОТРЕТЬ РАБОТУ ПОДОВ В МИНИКУБЕ

eval $(minikube docker-env)
docker ps | grep <name>  - вместо нейм то ли имя сервиса, то ли имя пода. тут будет 2 контейнера - тебе нужен верхний (можно по команде посмотреть, там один будет с CMD из докера, другой в паузе вроде) - ищешь тут первое поле
дальше docker exec -it <id> sh

ЗАМЕЧАНИЯ ПО ПОВОДУ ТЕЛЕГРАФА И МИНИКУБА
Ivan, [23.12.20 17:49]
[In reply to Ivan]
[ Photo ]
короче чтоб ты понимал. телеграф работает на своих плагинах
1. это плагин вывода. с ним более менее всё ок
2. это плагин ввода. и он у тебя не с докера собирает а только метрику cpu хоста

Ivan, [23.12.20 17:50]
[In reply to valarray]
это плохой образец

Ivan, [23.12.20 17:50]
вместе с телеграфом идёт в комплекте замечательный telegraf.conf

Ivan, [23.12.20 17:50]
в котором все абсолютно плагины

Ivan, [23.12.20 17:51]
тебе останется только раскомментить нужные

Ivan, [23.12.20 17:52]
[ Photo ]
у тебя будет чтото вроде этого через 2к+ строк

valarray, [23.12.20 17:52]
ясно, а я затираю как раз конф файл телеграфа, сейчас возьму его и скопипастю, а какие нужны плагины и где можно о них почитать на русском?

Ivan, [23.12.20 17:53]
там прямо на месте довольно простые комменты

Ivan, [23.12.20 17:53]
но по факту тебе нужно получать инфу о докерконтейнерах с сокета

Ivan, [23.12.20 17:53]
соответственно тебе нужно смонтировать /var/run/docker.sock из minikube в твой контейнер

Ivan, [23.12.20 17:54]
[ Photo ]
потому у тебя в докере будет типа такого

Ivan, [23.12.20 17:55]
[ Photo ]
а в твоём деплое будет чтото вроде этого

Ivan, [23.12.20 17:55]
(да можно монтировать и без pv)

valarray, [23.12.20 17:58]
Вань, я правильно понимаю что docker.sock сокеты надо монтировать  только если талеграф в отдельном поде, у меня он там же развернут где сама база инфлукс, зачем мне сокеты? или они нужны как раз чтобы зайти внуть контейнера и собрать метрики?

Ivan, [23.12.20 17:58]
ты можешь монтировать сокет куда тебе нужно

Ivan, [23.12.20 17:59]
ещё раз. ты монтируешь docker.sock за тем что изнутри контейнера ты не узнаешь чё происходит снаружи

Ivan, [23.12.20 17:59]
докерконтейнеры не знают о других докерконтейнерах

Ivan, [23.12.20 18:00]
как бы весь кубер стоит на докере

Ivan, [23.12.20 18:01]
ты монтируешь docker.sock который находится на хосте среды докера, который в нашем случае minikube vm
